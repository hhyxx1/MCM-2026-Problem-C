# Phase 3 帕累托优化与动态加权规则分析报告

**分析日期**: 2026年2月2日  
**分析目标**: 基于已有数据重新评估帕累托优化与动态加权+对数平滑规则模型

---

## 1. 分析概述

本报告基于34个赛季的粉丝投票估计数据，对多种投票规则进行了系统性的帕累托优化分析。分析涵盖365种规则配置，包括：
- 静态Rank规则（25种配置）
- 静态Pct规则（25种配置）
- 动态加权规则（35种配置）
- 动态+对数平滑规则（140种配置）
- 推荐规则（动态+对数+Judges' Save，140种配置）

---

## 2. 双目标定义

| 目标 | 符号 | 定义 | 期望方向 |
|------|------|------|----------|
| 精英选拔 | J | Spearman(最终排名, 评委排名) | 越高越好 |
| 粉丝参与 | F | Spearman(最终排名, 粉丝排名) | 越高越好 |
| 平衡度 | Balance | 2JF/(J+F) (调和平均) | 越高越好 |

---

## 3. 核心发现

### 3.1 Rank制 vs Pct制：Rank显著优于Pct

| 规则 | J值 | F值 | Balance | 相比当前规则 |
|------|-----|-----|---------|--------------|
| **当前规则 (Pct 50-50)** | 0.454 | 0.706 | 0.553 | 基准 |
| **Rank 50-50** | 0.665 | 0.704 | 0.684 | J+46.3%, F-0.3%, Balance+23.7% |

**关键洞察**：
- Rank制在J（精英选拔）维度上提升**46.3%**
- Rank制在F（粉丝参与）维度上仅下降**0.3%**（几乎无损失）
- 综合Balance提升**23.7%**

### 3.2 为什么Rank制更优？

**变异系数分析**：
- 粉丝票变异系数(CV)均值: **0.067**
- 评委分变异系数(CV)均值: **0.045**
- CV比值(粉丝/评委): **2.63×**

**机制解释**：
1. **Pct制对极端值敏感**：粉丝票的变异性是评委分的2.63倍，使用百分比直接加权会放大极端粉丝票的影响
2. **Rank制天然压缩极端值**：排名转换相当于一种非参数归一化，自动抑制了极端值
3. **Rank制等效于隐式对数平滑**：排名的压缩效应与对数变换的效果相似

### 3.3 动态加权规则的边际效益有限

| 规则类型 | 最优J | 最优F | 最优Balance |
|----------|-------|-------|-------------|
| Static Rank (50-50) | 0.665 | 0.704 | **0.684** |
| Best Dynamic+Log | 0.572 | 0.600 | 0.586 |
| Best Recommended (+Save) | 0.540 | 0.612 | 0.574 |

**结论**：
- 动态加权规则的最优Balance为0.586，**低于**静态Rank 50-50的0.684
- 动态规则相比最佳静态规则的改进为**-14.39%**（负向改进）
- 动态规则仅在30个赛季中的1个表现优于Rank 50-50

---

## 4. 敏感性分析

### 4.1 Base Weight敏感性（动态规则）

| Base Weight | J均值 | F均值 | Balance均值 |
|-------------|-------|-------|-------------|
| 40% | 0.563 | 0.605 | 0.576 |
| 45% | 0.631 | 0.539 | 0.570 |
| 50% | 0.692 | 0.473 | 0.553 |
| 55% | 0.754 | 0.407 | 0.523 |

### 4.2 Delta敏感性（每周权重增量）

| Delta | J均值 | F均值 | Balance均值 |
|-------|-------|-------|-------------|
| 0.01 | 0.572 | 0.597 | 0.576 |
| 0.015 | 0.636 | 0.534 | 0.569 |
| 0.02 | 0.692 | 0.474 | 0.554 |
| 0.025 | 0.746 | 0.415 | 0.527 |

### 4.3 Log Strength (α) 敏感性

| α | J均值 | F均值 | Balance均值 |
|---|-------|-------|-------------|
| 0.10 | 0.639 | 0.528 | 0.562 |
| 0.15 | 0.649 | 0.517 | 0.559 |
| 0.20 | 0.663 | 0.505 | 0.557 |
| 0.25 | 0.671 | 0.495 | 0.555 |
| 0.30 | 0.686 | 0.479 | 0.549 |

**敏感性结论**：
- 增大delta会提高J但显著降低F
- 增大α会提高J但降低F
- 所有动态配置均无法超越Rank 50-50的Balance

---

## 5. 推荐策略

### 5.1 首选推荐：Rank 50-50

$$\boxed{FinalRank = 0.5 \times JudgeRank + 0.5 \times FanRank}$$

**推荐理由**：
1. ✅ 实现最高Balance (0.684)
2. ✅ 简单易懂，易于向观众解释
3. ✅ 天然抗极端值干扰
4. ✅ 保持高粉丝参与度 (F=0.704)
5. ✅ 大幅提升精英选拔 (J=0.665, +46%)

### 5.2 备选方案：动态对数加权 + Judges' Save

适用场景：制片人希望在后期比赛中增加评委影响力

$$Score(t) = w_j(t) \cdot J\% + w_f(t) \cdot [\alpha \cdot \log(F\%) + (1-\alpha) \cdot F\%]$$

**参数**：
- base_judge_weight = 0.45 (第1周评委权重)
- delta_per_week = 0.015 (每周增量)
- log_strength (α) = 0.1
- Judges' Save: 当Bottom-2评委分差距>10%时触发

**权衡**：J提升18.8%，但F下降13.3%

---

## 6. 结论与行动建议

### 6.1 核心结论

| 发现 | 影响 |
|------|------|
| Rank制显著优于Pct制 | 建议将当前规则从Pct改为Rank |
| 动态加权无额外收益 | 不建议增加规则复杂度 |
| 对数平滑效果被Rank替代 | Rank本身即具备压缩极端值功能 |
| 简单规则最优 | 奥卡姆剃刀原则适用 |

### 6.2 给制片人的建议

1. **立即实施**：将投票规则从Pct 50-50改为Rank 50-50
2. **预期效果**：
   - 精英选拔能力提升46%
   - 粉丝参与度几乎不变（-0.3%）
   - 综合平衡度提升24%
3. **实施简便性**：无需复杂公式，仅需改变计分方式
4. **观众沟通**：可宣传为"更公平的双轨制评分"

---

## 7. 输出文件

| 文件 | 说明 |
|------|------|
| `all_pareto_points.csv` | 所有365种规则配置的评估结果 |
| `global_pareto_frontier.csv` | 全局帕累托前沿点 |
| `rule_comparison.csv` | 关键规则对比表 |
| `final_recommendation.json` | 最终推荐规则（JSON格式） |
| `pareto_frontier_analysis.png` | 帕累托前沿可视化 |
| `dynamic_weighting_analysis.png` | 动态权重演化图 |
| `rank_vs_pct_deep_analysis.png` | Rank vs Pct深度分析图 |
| `final_recommendation.png` | 最终推荐可视化 |
| `sensitivity_heatmap.png` | 参数敏感性热力图 |
| `season_rank_vs_pct.csv` | 逐赛季Rank vs Pct对比 |
| `extreme_value_analysis.csv` | 极端值敏感性分析 |

---

## 8. 技术说明

### 8.1 数据来源
- 粉丝投票估计：`cleaned_outputs/fan_vote_estimates.csv`（2777条观测，34个赛季）

### 8.2 分析方法
- 目标函数：Spearman相关系数
- 优化方法：网格搜索 + 帕累托前沿识别
- 膝点识别：到理想-反理想对角线的最大距离法

### 8.3 代码文件
- `phase3_pareto_analysis.py`：主分析脚本
- `phase3_pareto_extended.py`：扩展分析脚本

---

**报告生成时间**: 2026年2月2日
